<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Schema Change Monitor</title>
	<link rel="stylesheet" href="./css-js/style.css"/>
</head>
<body style="padding-left:15px">
	<h2 style="padding-left:5px">Comparison Date：2022/1/24</h2>

	<br />
	
<table>
	<tr height="10px;">
		<td id="p"><h2 style="font-family:Microsoft YaHei;text-align:center">Previous(2022/1/23)</h2></td>
		<td id="n"><h2 style="font-family:Microsoft YaHei;text-align:center">New(2022/1/24)</h2></td>
		<td id="diff_td"><h2 style="font-family:Microsoft YaHei;text-align:center">Diff</h2></td>
	</tr>
</table>
	<br />
<h1 style="padding-left:5px">Table Name：NCAPCNNGBI_CDI_DM_PUB.ETL_CNTRL</h1>
<table>
	<tr height="300px">
		<td contenteditable="true" id="a">CREATE TABLE
    { database_name.schema_name.table_name2 | schema_name.table_name | table_name }
    [ AS FileTable ]
    ( {   <column_definition>
        | <computed_column_definition>
        | <column_set_definition>
        | [ <table_constraint> ] [ ,... n ]
        | [ <table_index> ] }
          [ ,...n ]
          [ PERIOD FOR SYSTEM_TIME ( system_start_time_column_name
             , system_end_time_column_name ) ]
      )
    [ ON { partition_scheme_name ( partition_column_name )
           | filegroup
           | "default" } ]
    [ TEXTIMAGE_ON { filegroup | "default" } ]
    [ FILESTREAM_ON { partition_scheme_name
           | filegroup
           | "default" } ]
    [ WITH ( <table_option> [ ,...n ] ) ]
[ ; ]</td>
		<td contenteditable="true" id="b">CREATE TABLE
    { database_name.schema_name.table_name | schema_name.table_name | table_name }
    [ AS FileTable ]
    ( {   <column_definition>
        | <computed_column_definition>
        | <column_set_definition>
        | [ <table_constraint> ] [ ,... n ]
        | [ <table_index> ] }
          [ ,...n ]
          [ PERIOD FOR SYSTEM_TIME ( system_start_time_column_name
             , system_end_time_column_name ) ]
      )
    [ ON { partition_scheme_name ( partition_column_name )
           | filegroup
           | "default" } ]
    [ TEXTIMAGE_ON { filegroup | "default" } ]
           | filegroup
           | "default" } ]
    [ WITH ( <table_option> [ ,...n ] ) ]
[ ; ]</td>
		<td>
		<div id="result"></div>
		<textarea style="float:left;width:100%" placeholder="Sprint: Data Sprint 202X-X
Story:  https://issues.merck.com/browse/OCB-XXXX
Owner:  XXX
Migration Team:" rows=4>Sprint: 
Story:  
Owner:  </textarea>
		<br />		
		<br />
		<button>Submit</button>
		</td>
	</tr>
</table>
	<br />
<h1  style="padding-left:5px">Table Name：NCAPCNNGBI_CDI_DM_ETL.FCT_INMRKT_SLS_DDI_SVH_HIST</h1>
<table>
	<tr height="300px">
		<td contenteditable="true" id="a2">CREATE TABLE
    { database_name.schema_name.table_name | schema_name.table_name | table_name }
    [ AS FileTable ]
    ( {   <column_definition>
        | <computed_column_definition>
        | <column_set_definition>
        | [ <table_constraint> ] [ ,... n ]
          [ ,...n ]
          [ PERIOD FOR SYSTEM_TIME ( system_start_time_column_name
             , system_end_time_column_name ) ]
      )
    [ ON { partition_scheme_name ( partition_column_name )
           | filegroup
           | "default" } ]
    [ TEXTIMAGE_ON { filegroup | "default" } ]
    [ FILESTREAM_ON { partition_scheme_name
           | filegroup
           | "default" } ]
    [ WITH ( <table_option> [ ,...n ] ) ]
[ ; ]</td>
		<td contenteditable="true" id="b2">CREATE TABLE
    { database_name.schema_name.table_name | schema_name.table_name | table_name }
    [ AS FileTable ]
    ( {   <column_definition>
        | <computed_column_definition>
        | <column_set_definition>
        | [ <table_constraint> ] [ ,... n ]
        | [ <table_index> ] }
          [ ,...n ]
          [ PERIOD FOR SYSTEM_TIME ( system_start_time_column_name
             , system_end_time_column_name ) ]
      )
    [ ON { partition_scheme_name ( partition_column_name )
           | filegroup
           | "default" } ]
    [ TEXTIMAGE_ON { filegroup | "default" } ]
    [ FILESTREAM_ON { partition_scheme_name
           | filegroup
           | "default" } ]
    [ WITH ( <table_option> [ ,...n ] ) ]
[ ; ]</td>
		<td id="result2"></td>
	</tr>
</table>
	<br />
<h1 style="padding-left:5px">Table Name：NCAPCNNGBI_CDI_DM_PUB.FCT_INMRKT_SLS_DDI_SVH_UNIF</h1>
<table>
	<tr height="300px">
		<td contenteditable="true" id="a3">CREATE TABLE
    { database_name.schema_name.table_name | schema_name.table_name | table_name }
    [ AS FileTable ]
    ( {   <column_definition>
        | <computed_column_definition>
        | <column_set_definition>
        | [ <table_constraint> ] [ ,... n ]
        | [ <table_index> ] }
          [ ,...n ]
          [ PERIOD FOR SYSTEM_TIME ( system_start_time_column_name
             , system_end_time_column_name ) ]
      )
    [ ON { partition_scheme_name ( partition_column_name )
           | filegroup
           | "default" } ]
    [ TEXTIMAGE_ON { filegroup | "default" } ]
    [ FILESTREAM_ON { partition_scheme_name
           | filegroup
           | "default" } ]
    [ WITH ( <table_option> [ ,...n ] ) ]
[ ; ]</td>
		<td contenteditable="true" id="b3">CREATE TABLE
    { database_name.schema_name.table_name | schema_name.table_name | table_name }
    [ AS FileTable ]
    ( {   <column_definition>
        | <computed_column_definition>
        | <column_set_definition>
        | [ <table_constraint> ] [ ,... n ]
        | [ <table_index> ] }
          [ ,...n ]
          [ PERIOD FOR SYSTEM_TIME ( system_start_time_column_name
             , system_end_time_column_name ) ]
      )
    [ ON { partition_scheme_name ( partition_column_name )
           | filegroup
           | "default" } ]
    [ TEXTIMAGE_ON { filegroup | "default" } ]
    [ FILESTREAM_ON { partition_scheme_name
           | filegroup
           | "default" } ]
    [ WITH ( <table_option> [ ,...n ] ) ]
[ ; ]</td>
		<td id="result3"></td>
	</tr>
</table>
	<br />
<script src="./css-js/diff.js"></script>
<script defer>
var a = document.getElementById('a');
var b = document.getElementById('b');
var result = document.getElementById('result');

function changed() {
	var diff = Diff['diffLines'](a.textContent, b.textContent);
	var fragment = document.createDocumentFragment();
	var j = 0;
	for (var i=0; i < diff.length; i++) {
		if (diff[i].added && diff[i + 1] && diff[i + 1].removed) {
			var swap = diff[i];
			diff[i] = diff[i + 1];
			diff[i + 1] = swap;
		}
		var node;
		if (diff[i].removed) {
			j = j+1;
			node = document.createElement('del');
			node.appendChild(document.createTextNode(diff[i].value.replace(/[\r\n]/g,"") + " --CL" + j.toString()+"\r\n"));
		} else if (diff[i].added) {
			j = j+1;
			node = document.createElement('ins');
			node.appendChild(document.createTextNode(diff[i].value.replace(/[\r\n]/g,"") + " --CL" + j.toString()+"\r\n"));
		} else {
			node = document.createTextNode(diff[i].value);
		}
		fragment.appendChild(node);
	}

	result.textContent = '';
	result.appendChild(fragment);
}

window.onload = function() {
	//onDiffTypeChange(document.querySelector('#settings [name="diff_type"]:checked'));
	changed();
};


a.onpaste = a.onchange =
b.onpaste = b.onchange =
result.onpaste = result.onchange =
 changed;

if ('oninput' in a) {
	a.oninput = b.oninput = result.oninput = changed;
} else {
	a.onkeyup = b.onkeyup = result.onkeyup = changed;
}

//function onDiffTypeChange(radio) {
//	window.diffType = radio.value;
//	document.title = "Diff " + radio.parentNode.innerText;
//	if(window.diffType == "applyPatch") {
//		b.removeAttribute('contenteditable');
//		result.setAttribute('contenteditable','true');
//	} else {
//		result.removeAttribute('contenteditable');
//		b.setAttribute('contenteditable','true');
//	}
//}
//
//var radio = document.getElementsByName('diff_type');
//for (var i = 0; i < radio.length; i++) {
//	radio[i].onchange = function(e) {
//		onDiffTypeChange(e.target);
//		changed();
//	}
//}
</script>
</body>
</html>
